%% 2 Dots

args = struct(...
	'nDots',        2, ...
    'N0',           50*ones(2, 1), ...
	'Cg',           .5e-17*[1 1], ...
	'Cl',           .5e-17*[1 1], ...
	'Cm',           3e-18*[1], ...
    'Cij',          2e-18*[1; 1], ...
    'Vl',           1e-3*[0 0], ...
    'coeff',        [1 0 0; ...                     
                     0 1 0], ...
	'lims',         1e-0*[-1.15, -1.1; -1.15, -1.1], ...  % x and y lims for voltages
    'nPoints',      [500, 500], ...
    'distances',    2e-7*[6 7; 7 6], ...
    'useEnergies',  false, ...
    'Ec',           [7.2 11.5 11.5 7.2]*1e-3*util.const.e, ...
    'Ecm',          [1.5 1.2 1.5 .2 .2 .02]*1e-3*util.const.e, ...
    'smearing',     false, ...
    'sweepSpeed',   1e-3, ...
    'tau',          0.5, ...
	'e' ,           util.const.e, ...
	'e2',           util.const.e^2, ...
    'eps_0',        util.const.eps_0 ...
	);

%% 4 Dots

epsilon_center=.0;


args = struct(...
	'nDots',        4, ...
    'N0',           50*ones(4, 1), ...
	'Cg',           .5e-17*[1 1 1 1], ...
	'Cl',           .5e-17*[1 1 1 1], ...
	'Cm',           3e-18*[1 1 1], ...
    'Cij',          2e-18*[1 1 1; 1 1 1], ...
    'Vl',           1e-3*[1 1 1 1], ...
    'coeff',        [1 0 -epsilon_center; ...                     
                     1 0 -epsilon_center;...
                     0 1. epsilon_center;...
                     0 1 epsilon_center], ...
	'lims',         1e-0*[-1.15, -1.; -1.15, -1.]+1, ...  % x and y lims for voltages
    'nPoints',      [500, 500], ...
    'distances',    2e-7*[6 7 8 9;9 8 7 6], ...
    'useEnergies',  false, ...
    'Ec',           [7.2 11.5 11.5 7.2]*1e-3*util.const.e, ...
    'Ecm',          [1.5 1.2 1.5 .2 .2 .02]*1e-3*util.const.e, ...
    'smearing',     false, ...
    'sweepSpeed',   1e-3, ...
    'tau',          0.5, ...
	'e' ,           util.const.e, ...
	'e2',           util.const.e^2, ...
    'eps_0',        util.const.eps_0 ...
	);
% profile on
dot_tune.capacitive_gate_model(args);
% profile viewer
%%
epsilon_left=0;
epsilon_right=0;
epsilon_center=0.;

f=figure();
hold on
i=1;
for epsilon_center=-0.4:0.01:-0.31
args = struct(...
	'nDots',        4, ...
    'N0',           50*ones(4, 1), ...
	'Cg',           .5e-17*[1 1 1 1], ...
	'Cl',           .5e-17*[1 1 1 1], ...
	'Cm',           3e-18*[1 1 1], ...
    'Cij',          2e-18*[1 1 1; 1 1 1], ...
    'Vl',           1e-3*[1 1 1 1], ...
    'coeff',        [1 0 -epsilon_center; ...                     
                     0 1 -epsilon_center;...
                     0 0. epsilon_center;...
                     0 0 epsilon_center], ...
	'lims',         1e-0*[-1.15, -1.; -1.15, -1.]+1, ...  % x and y lims for voltages
    'nPoints',      [500, 500], ...
    'distances',    2e-7*[6 7 8 9;9 8 7 6], ...
    'useEnergies',  false, ...
    'Ec',           [7.2 11.5 11.5 7.2]*1e-3*util.const.e, ...
    'Ecm',          [1.5 1.2 1.5 .2 .2 .02]*1e-3*util.const.e, ...
    'smearing',     false, ...
    'sweepSpeed',   1e-3, ...
    'tau',          0.5, ...
	'e' ,           util.const.e, ...
	'e2',           util.const.e^2, ...
    'eps_0',        util.const.eps_0 ...
	);

dot_tune.capacitive_gate_model(args);
i
figure(f)
subplot(2,5,i),imagesc(ans{2})
shading flat;
view(2);
i=i+1;
end